
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Configuring user environments &#8212; JupyterHub 3.1.0.dev documentation</title>
  <script>
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1e1de1a1873e13ef5536" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1e1de1a1873e13ef5536" rel="stylesheet">

  
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/6.1.2/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1e1de1a1873e13ef5536">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'reference/config-user-env';</script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Configuration examples" href="config-examples.html" />
    <link rel="prev" title="JupyterHub server events" href="../events/server-actions.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">

  
  
  
  
  
  
  

  
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image">
    <img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  
  <div class=" navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="../installation-guide.html">
                        Installation
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../getting-started/index.html">
                        Get Started
                    </a>
                </li>
                

                <li class="nav-item current active">
                    <a class="nav-link" href="index.html">
                        Technical Reference
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../index-admin.html">
                        Administrator’s Guide
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../api/index.html">
                        JupyterHub API
                    </a>
                </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                <li class="nav-item">
                    <a class="nav-link" href="../rbac/index.html">
                        JupyterHub RBAC
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../contributing/index.html">
                        Contributing
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../index-about.html">
                        About
                    </a>
                </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      <div class="navbar-end-item navbar-end__search-button-container">
        
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
      </div>
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" data-toggle="tooltip">
    <a class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="fa-regular fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/jupyterhub/jupyterhub" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://discourse.jupyter.org/c/jupyterhub/10" title="Discourse" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-discourse"></i></span>
            <label class="sr-only">Discourse</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  <div class="search-button-container--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
  </div>

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="../installation-guide.html">
                        Installation
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../getting-started/index.html">
                        Get Started
                    </a>
                </li>
                

                <li class="nav-item current active">
                    <a class="nav-link" href="index.html">
                        Technical Reference
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../index-admin.html">
                        Administrator’s Guide
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../api/index.html">
                        JupyterHub API
                    </a>
                </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                <li class="nav-item">
                    <a class="nav-link" href="../rbac/index.html">
                        JupyterHub RBAC
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../contributing/index.html">
                        Contributing
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../index-about.html">
                        About
                    </a>
                </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" data-toggle="tooltip">
    <a class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="fa-regular fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/jupyterhub/jupyterhub" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://discourse.jupyter.org/c/jupyterhub/10" title="Discourse" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-discourse"></i></span>
            <label class="sr-only">Discourse</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Section navigation">
  <p class="bd-links__title" role="heading" aria-level="1">
    Section Navigation
  </p>
  <div class="bd-toc-item navbar-nav">
    <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="technical-overview.html">Technical Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="urls.html">JupyterHub URL scheme</a></li>
<li class="toctree-l1"><a class="reference internal" href="websecurity.html">Security Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="authenticators.html">Authenticators</a></li>
<li class="toctree-l1"><a class="reference internal" href="spawners.html">Spawners</a></li>
<li class="toctree-l1"><a class="reference internal" href="services.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="proxy.html">Writing a custom Proxy implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="separate-proxy.html">Running proxy separately from the hub</a></li>
<li class="toctree-l1"><a class="reference internal" href="rest.html">Using JupyterHub’s REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="rest-api.html">JupyterHub REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="server-api.html">Starting servers with the JupyterHub API</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="monitoring.html">Monitoring</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="metrics.html">List of Prometheus Metrics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="database.html">The Hub’s Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="templates.html">Working with templates and UI</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-only.html">Deploying JupyterHub in “API only mode”</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../events/index.html">Eventlogging and Telemetry</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../events/server-actions.html">JupyterHub server events</a></li>
</ul>
</li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Configuring user environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="config-examples.html">Configuration examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="config-ghoauth.html">Configure GitHub OAuth</a></li>
<li class="toctree-l1"><a class="reference internal" href="config-proxy.html">Using a reverse proxy</a></li>
<li class="toctree-l1"><a class="reference internal" href="config-sudo.html">Run JupyterHub without root privileges using <code class="docutils literal notranslate"><span class="pre">sudo</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="config-reference.html">Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth.html">JupyterHub and OAuth</a></li>
</ul>

  </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

      </div>
      <main class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <section id="configuring-user-environments">
<h1>Configuring user environments<a class="headerlink" href="#configuring-user-environments" title="Permalink to this heading">#</a></h1>
<p>Deploying JupyterHub means you are providing Jupyter notebook environments for
multiple users. Often, this includes a desire to configure the user
environment in some way.</p>
<p>Since the <code class="docutils literal notranslate"><span class="pre">jupyterhub-singleuser</span></code> server extends the standard Jupyter notebook
server, most configuration and documentation that applies to Jupyter Notebook
applies to the single-user environments. Configuration of user environments
typically does not occur through JupyterHub itself, but rather through system-
wide configuration of Jupyter, which is inherited by <code class="docutils literal notranslate"><span class="pre">jupyterhub-singleuser</span></code>.</p>
<p><strong>Tip:</strong> When searching for configuration tips for JupyterHub user
environments, try removing JupyterHub from your search because there are a lot
more people out there configuring Jupyter than JupyterHub and the
configuration is the same.</p>
<p>This section will focus on user environments, including:</p>
<ul class="simple">
<li><p>Installing packages</p></li>
<li><p>Configuring Jupyter and IPython</p></li>
<li><p>Installing kernelspecs</p></li>
<li><p>Using containers vs. multi-user hosts</p></li>
</ul>
<section id="installing-packages">
<h2>Installing packages<a class="headerlink" href="#installing-packages" title="Permalink to this heading">#</a></h2>
<p>To make packages available to users, you generally will install packages
system-wide or in a shared environment.</p>
<p>This installation location should always be in the same environment that
<code class="docutils literal notranslate"><span class="pre">jupyterhub-singleuser</span></code> itself is installed in, and must be <em>readable and
executable</em> by your users. If you want users to be able to install additional
packages, it must also be <em>writable</em> by your users.</p>
<p>If you are using a standard system Python install, you would use:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo python3 -m pip install numpy
</pre></div>
</div>
<p>to install the numpy package in the default system Python 3 environment
(typically <code class="docutils literal notranslate"><span class="pre">/usr/local</span></code>).</p>
<p>You may also use conda to install packages. If you do, you should make sure
that the conda environment has appropriate permissions for users to be able to
run Python code in the env.</p>
</section>
<section id="configuring-jupyter-and-ipython">
<h2>Configuring Jupyter and IPython<a class="headerlink" href="#configuring-jupyter-and-ipython" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://jupyter-notebook.readthedocs.io/en/stable/config_overview.html">Jupyter</a>
and <a class="reference external" href="https://ipython.readthedocs.io/en/stable/development/config.html">IPython</a>
have their own configuration systems.</p>
<p>As a JupyterHub administrator, you will typically want to install and configure
environments for all JupyterHub users. For example, you wish for each student in
a class to have the same user environment configuration.</p>
<p>Jupyter and IPython support <strong>“system-wide”</strong> locations for configuration, which
is the logical place to put global configuration that you want to affect all
users. It’s generally more efficient to configure user environments “system-wide”,
and it’s a good idea to avoid creating files in users’ home directories.</p>
<p>The typical locations for these config files are:</p>
<ul class="simple">
<li><p><strong>system-wide</strong> in <code class="docutils literal notranslate"><span class="pre">/etc/{jupyter|ipython}</span></code></p></li>
<li><p><strong>env-wide</strong> (environment wide) in <code class="docutils literal notranslate"><span class="pre">{sys.prefix}/etc/{jupyter|ipython}</span></code>.</p></li>
</ul>
<section id="example-enable-an-extension-system-wide">
<h3>Example: Enable an extension system-wide<a class="headerlink" href="#example-enable-an-extension-system-wide" title="Permalink to this heading">#</a></h3>
<p>For example, to enable the <code class="docutils literal notranslate"><span class="pre">cython</span></code> IPython extension for all of your users,
create the file <code class="docutils literal notranslate"><span class="pre">/etc/ipython/ipython_config.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">InteractiveShellApp</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;cython&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="example-enable-a-jupyter-notebook-configuration-setting-for-all-users">
<h3>Example: Enable a Jupyter notebook configuration setting for all users<a class="headerlink" href="#example-enable-a-jupyter-notebook-configuration-setting-for-all-users" title="Permalink to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These examples configure the Jupyter ServerApp,
which is used by JupyterLab, the default in JupyterHub 2.0.</p>
<p>If you are using the classing Jupyter Notebook server,
the same things should work,
with the following substitutions:</p>
<ul class="simple">
<li><p>Where you see <code class="docutils literal notranslate"><span class="pre">jupyter_server_config</span></code>, use <code class="docutils literal notranslate"><span class="pre">jupyter_notebook_config</span></code></p></li>
<li><p>Where you see <code class="docutils literal notranslate"><span class="pre">NotebookApp</span></code>, use <code class="docutils literal notranslate"><span class="pre">ServerApp</span></code></p></li>
</ul>
</div>
<p>To enable Jupyter notebook’s internal idle-shutdown behavior (requires
notebook ≥ 5.4), set the following in the <code class="docutils literal notranslate"><span class="pre">/etc/jupyter/jupyter_server_config.py</span></code>
file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># shutdown the server after no activity for an hour</span>
<span class="n">c</span><span class="o">.</span><span class="n">ServerApp</span><span class="o">.</span><span class="n">shutdown_no_activity_timeout</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span>
<span class="c1"># shutdown kernels after no activity for 20 minutes</span>
<span class="n">c</span><span class="o">.</span><span class="n">MappingKernelManager</span><span class="o">.</span><span class="n">cull_idle_timeout</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="mi">60</span>
<span class="c1"># check for idle kernels every two minutes</span>
<span class="n">c</span><span class="o">.</span><span class="n">MappingKernelManager</span><span class="o">.</span><span class="n">cull_interval</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">60</span>
</pre></div>
</div>
</section>
</section>
<section id="installing-kernelspecs">
<h2>Installing kernelspecs<a class="headerlink" href="#installing-kernelspecs" title="Permalink to this heading">#</a></h2>
<p>You may have multiple Jupyter kernels installed and want to make sure that
they are available to all of your users. This means installing kernelspecs
either system-wide (e.g. in /usr/local/) or in the <code class="docutils literal notranslate"><span class="pre">sys.prefix</span></code> of JupyterHub
itself.</p>
<p>Jupyter kernelspec installation is system wide by default, but some kernels
may default to installing kernelspecs in your home directory. These will need
to be moved system-wide to ensure that they are accessible.</p>
<p>You can see where your kernelspecs are with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>jupyter kernelspec list
</pre></div>
</div>
<section id="example-installing-kernels-system-wide">
<h3>Example: Installing kernels system-wide<a class="headerlink" href="#example-installing-kernels-system-wide" title="Permalink to this heading">#</a></h3>
<p>Assuming I have a Python 2 and Python 3 environment that I want to make
sure are available, I can install their specs system-wide (in /usr/local) with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>/path/to/python3 -m ipykernel install --prefix<span class="o">=</span>/usr/local
/path/to/python2 -m ipykernel install --prefix<span class="o">=</span>/usr/local
</pre></div>
</div>
</section>
</section>
<section id="multi-user-hosts-vs-containers">
<h2>Multi-user hosts vs. Containers<a class="headerlink" href="#multi-user-hosts-vs-containers" title="Permalink to this heading">#</a></h2>
<p>There are two broad categories of user environments that depend on what
Spawner you choose:</p>
<ul class="simple">
<li><p>Multi-user hosts (shared system)</p></li>
<li><p>Container-based</p></li>
</ul>
<p>How you configure user environments for each category can differ a bit
depending on what Spawner you are using.</p>
<p>The first category is a <strong>shared system (multi-user host)</strong> where
each user has a JupyterHub account and a home directory as well as being
a real system user. In this example, shared configuration and installation
must be in a ‘system-wide’ location, such as <code class="docutils literal notranslate"><span class="pre">/etc/</span></code> or <code class="docutils literal notranslate"><span class="pre">/usr/local</span></code>
or a custom prefix such as <code class="docutils literal notranslate"><span class="pre">/opt/conda</span></code>.</p>
<p>When JupyterHub uses <strong>container-based</strong> Spawners (e.g. KubeSpawner or
DockerSpawner), the ‘system-wide’ environment is really the container image
which you are using for users.</p>
<p>In both cases, you want to <em>avoid putting configuration in user home
directories</em> because users can change those configuration settings. Also,
home directories typically persist once they are created, so they are
difficult for admins to update later.</p>
</section>
<section id="named-servers">
<h2>Named servers<a class="headerlink" href="#named-servers" title="Permalink to this heading">#</a></h2>
<p>By default, in a JupyterHub deployment each user has exactly one server.</p>
<p>JupyterHub can, however, have multiple servers per user.
This is most useful in deployments where users can configure the environment
in which their server will start (e.g. resource requests on an HPC cluster),
so that a given user can have multiple configurations running at the same time,
without having to stop and restart their one server.</p>
<p>To allow named servers:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">JupyterHub</span><span class="o">.</span><span class="n">allow_named_servers</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p>Named servers were implemented in the REST API in JupyterHub 0.8,
and JupyterHub 1.0 introduces UI for managing named servers via the user home page:</p>
<p><img alt="named servers on the home page" src="../_images/named-servers-home.png" /></p>
<p>as well as the admin page:</p>
<p><img alt="named servers on the admin page" src="../_images/named-servers-admin.png" /></p>
<p>Named servers can be accessed, created, started, stopped, and deleted
from these pages. Activity tracking is now per-server as well.</p>
<p>The number of named servers per user can be limited by setting a constant value:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">JupyterHub</span><span class="o">.</span><span class="n">named_server_limit_per_user</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
<p>or a callable/awaitable based on the handler object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">named_server_limit_per_user_fn</span><span class="p">(</span><span class="n">handler</span><span class="p">):</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">current_user</span>
    <span class="k">if</span> <span class="n">user</span> <span class="ow">and</span> <span class="n">user</span><span class="o">.</span><span class="n">admin</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="mi">5</span>

<span class="n">c</span><span class="o">.</span><span class="n">JupyterHub</span><span class="o">.</span><span class="n">named_server_limit_per_user</span> <span class="o">=</span> <span class="n">named_server_limit_per_user_fn</span>
</pre></div>
</div>
<p>This can be useful for quota service implementations. The example above limits the number of named servers for non-admin users only.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">named_server_limit_per_user</span></code> is set to <code class="docutils literal notranslate"><span class="pre">0</span></code>, no limit is enforced.</p>
</section>
<section id="switching-back-to-classic-notebook">
<span id="classic-notebook-ui"></span><h2>Switching back to classic notebook<a class="headerlink" href="#switching-back-to-classic-notebook" title="Permalink to this heading">#</a></h2>
<p>By default the single-user server launches JupyterLab,
which is based on <a class="reference external" href="https://jupyter-server.readthedocs.io">Jupyter Server</a>.
This is the default server when running JupyterHub ≥ 2.0.
You can switch to using the legacy Jupyter Notebook server by setting the <code class="docutils literal notranslate"><span class="pre">JUPYTERHUB_SINGLEUSER_APP</span></code> environment variable
(in the single-user environment) to:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">JUPYTERHUB_SINGLEUSER_APP</span><span class="o">=</span><span class="s1">&#39;notebook.notebookapp.NotebookApp&#39;</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.0: </span>JupyterLab is now the default singleuser UI, if available,
which is based on the <a class="reference external" href="https://jupyter-server.readthedocs.io">Jupyter Server</a>,
no longer the legacy <a class="reference external" href="https://jupyter-notebook.readthedocs.io">Jupyter Notebook</a> server.
JupyterHub prior to 2.0 launched the legacy notebook server (<code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">notebook</span></code>),
and Jupyter server could be selected by specifying</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># jupyterhub_config.py</span>
<span class="n">c</span><span class="o">.</span><span class="n">Spawner</span><span class="o">.</span><span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;jupyter-labhub&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>or for an otherwise customized Jupyter Server app,
set the environment variable:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">JUPYTERHUB_SINGLEUSER_APP</span><span class="o">=</span><span class="s1">&#39;jupyter_server.serverapp.ServerApp&#39;</span>
</pre></div>
</div>
</div>
</section>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="../events/server-actions.html" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">JupyterHub server events</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="config-examples.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">Configuration examples</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#installing-packages">
   Installing packages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#configuring-jupyter-and-ipython">
   Configuring Jupyter and IPython
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-enable-an-extension-system-wide">
     Example: Enable an extension system-wide
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-enable-a-jupyter-notebook-configuration-setting-for-all-users">
     Example: Enable a Jupyter notebook configuration setting for all users
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#installing-kernelspecs">
   Installing kernelspecs
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-installing-kernels-system-wide">
     Example: Installing kernels system-wide
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multi-user-hosts-vs-containers">
   Multi-user hosts vs. Containers
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#named-servers">
   Named servers
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#switching-back-to-classic-notebook">
   Switching back to classic notebook
  </a>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  

<div class="tocsection editthispage">
    <a href="https://github.com/jupyterhub/jupyterhub/edit/main/docs/reference/config-user-env.md">
        <i class="fa-solid fa-pencil"></i> Edit this page
    </a>
</div>

</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="../_sources/reference/config-user-env.md.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>

</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1e1de1a1873e13ef5536"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2016, Project Jupyter team.<br>

</p>

  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>