
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Security settings &#8212; JupyterHub 3.1.0.dev documentation</title>
  <script>
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1e1de1a1873e13ef5536" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1e1de1a1873e13ef5536" rel="stylesheet">

  
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/6.1.2/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1e1de1a1873e13ef5536">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'getting-started/security-basics';</script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Authentication and User Basics" href="authenticators-users-basics.html" />
    <link rel="prev" title="Networking basics" href="networking-basics.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">

  
  
  
  
  
  
  

  
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image">
    <img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  
  <div class=" navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="../installation-guide.html">
                        Installation
                    </a>
                </li>
                

                <li class="nav-item current active">
                    <a class="nav-link" href="index.html">
                        Get Started
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../reference/index.html">
                        Technical Reference
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../index-admin.html">
                        Administrator’s Guide
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../api/index.html">
                        JupyterHub API
                    </a>
                </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                <li class="nav-item">
                    <a class="nav-link" href="../rbac/index.html">
                        JupyterHub RBAC
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../contributing/index.html">
                        Contributing
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../index-about.html">
                        About
                    </a>
                </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      <div class="navbar-end-item navbar-end__search-button-container">
        
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
      </div>
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" data-toggle="tooltip">
    <a class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="fa-regular fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/jupyterhub/jupyterhub" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://discourse.jupyter.org/c/jupyterhub/10" title="Discourse" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-discourse"></i></span>
            <label class="sr-only">Discourse</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  <div class="search-button-container--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
  </div>

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="../installation-guide.html">
                        Installation
                    </a>
                </li>
                

                <li class="nav-item current active">
                    <a class="nav-link" href="index.html">
                        Get Started
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../reference/index.html">
                        Technical Reference
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../index-admin.html">
                        Administrator’s Guide
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../api/index.html">
                        JupyterHub API
                    </a>
                </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                <li class="nav-item">
                    <a class="nav-link" href="../rbac/index.html">
                        JupyterHub RBAC
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../contributing/index.html">
                        Contributing
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../index-about.html">
                        About
                    </a>
                </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" data-toggle="tooltip">
    <a class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="fa-regular fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/jupyterhub/jupyterhub" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://discourse.jupyter.org/c/jupyterhub/10" title="Discourse" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-discourse"></i></span>
            <label class="sr-only">Discourse</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Section navigation">
  <p class="bd-links__title" role="heading" aria-level="1">
    Section Navigation
  </p>
  <div class="bd-toc-item navbar-nav">
    <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="config-basics.html">Configuration Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="networking-basics.html">Networking basics</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Security settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="authenticators-users-basics.html">Authentication and User Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="spawners-basics.html">Spawners and single-user notebook servers</a></li>
<li class="toctree-l1"><a class="reference internal" href="services-basics.html">External services</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="institutional-faq.html">Institutional FAQ</a></li>
</ul>

  </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

      </div>
      <main class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <section id="security-settings">
<h1>Security settings<a class="headerlink" href="#security-settings" title="Permalink to this heading">#</a></h1>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>You should not run JupyterHub without SSL encryption on a public network.</p>
</div>
<p>Security is the most important aspect of configuring Jupyter. Three
configuration settings are the main aspects of security configuration:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#ssl-encryption"><span class="std std-ref">SSL encryption</span></a> (to enable HTTPS)</p></li>
<li><p><a class="reference internal" href="#cookie-secret"><span class="std std-ref">Cookie secret</span></a> (a key for encrypting browser cookies)</p></li>
<li><p>Proxy <a class="reference internal" href="#authentication-token"><span class="std std-ref">authentication token</span></a> (used for the Hub and
other services to authenticate to the Proxy)</p></li>
</ol>
<p>The Hub hashes all secrets (e.g., auth tokens) before storing them in its
database. A loss of control over read-access to the database should have
minimal impact on your deployment; if your database has been compromised, it
is still a good idea to revoke existing tokens.</p>
<section id="enabling-ssl-encryption">
<span id="ssl-encryption"></span><h2>Enabling SSL encryption<a class="headerlink" href="#enabling-ssl-encryption" title="Permalink to this heading">#</a></h2>
<p>Since JupyterHub includes authentication and allows arbitrary code execution,
you should not run it without SSL (HTTPS).</p>
<section id="using-an-ssl-certificate">
<h3>Using an SSL certificate<a class="headerlink" href="#using-an-ssl-certificate" title="Permalink to this heading">#</a></h3>
<p>This will require you to obtain an official, trusted SSL certificate or create a
self-signed certificate. Once you have obtained and installed a key and
certificate you need to specify their locations in the <code class="docutils literal notranslate"><span class="pre">jupyterhub_config.py</span></code>
configuration file as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">JupyterHub</span><span class="o">.</span><span class="n">ssl_key</span> <span class="o">=</span> <span class="s1">&#39;/path/to/my.key&#39;</span>
<span class="n">c</span><span class="o">.</span><span class="n">JupyterHub</span><span class="o">.</span><span class="n">ssl_cert</span> <span class="o">=</span> <span class="s1">&#39;/path/to/my.cert&#39;</span>
</pre></div>
</div>
<p>Some cert files also contain the key, in which case only the cert is needed. It
is important that these files be put in a secure location on your server, where
they are not readable by regular users.</p>
<p>If you are using a <strong>chain certificate</strong>, see also chained certificate for SSL
in the JupyterHub <a class="reference external" href="../troubleshooting.html">Troubleshooting FAQ</a>.</p>
</section>
<section id="using-letsencrypt">
<h3>Using letsencrypt<a class="headerlink" href="#using-letsencrypt" title="Permalink to this heading">#</a></h3>
<p>It is also possible to use <a class="reference external" href="https://letsencrypt.org/">letsencrypt</a> to obtain
a free, trusted SSL certificate. If you run letsencrypt using the default
options, the needed configuration is (replace <code class="docutils literal notranslate"><span class="pre">mydomain.tld</span></code> by your fully
qualified domain name):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">JupyterHub</span><span class="o">.</span><span class="n">ssl_key</span> <span class="o">=</span> <span class="s1">&#39;/etc/letsencrypt/live/</span><span class="si">{mydomain.tld}</span><span class="s1">/privkey.pem&#39;</span>
<span class="n">c</span><span class="o">.</span><span class="n">JupyterHub</span><span class="o">.</span><span class="n">ssl_cert</span> <span class="o">=</span> <span class="s1">&#39;/etc/letsencrypt/live/</span><span class="si">{mydomain.tld}</span><span class="s1">/fullchain.pem&#39;</span>
</pre></div>
</div>
<p>If the fully qualified domain name (FQDN) is <code class="docutils literal notranslate"><span class="pre">example.com</span></code>, the following
would be the needed configuration:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">JupyterHub</span><span class="o">.</span><span class="n">ssl_key</span> <span class="o">=</span> <span class="s1">&#39;/etc/letsencrypt/live/example.com/privkey.pem&#39;</span>
<span class="n">c</span><span class="o">.</span><span class="n">JupyterHub</span><span class="o">.</span><span class="n">ssl_cert</span> <span class="o">=</span> <span class="s1">&#39;/etc/letsencrypt/live/example.com/fullchain.pem&#39;</span>
</pre></div>
</div>
</section>
<section id="if-ssl-termination-happens-outside-of-the-hub">
<h3>If SSL termination happens outside of the Hub<a class="headerlink" href="#if-ssl-termination-happens-outside-of-the-hub" title="Permalink to this heading">#</a></h3>
<p>In certain cases, for example if the hub is running behind a reverse proxy, and
<a class="reference external" href="https://www.nginx.com/resources/admin-guide/nginx-ssl-termination/">SSL termination is being provided by NGINX</a>,
it is reasonable to run the hub without SSL.</p>
<p>To achieve this, simply omit the configuration settings
<code class="docutils literal notranslate"><span class="pre">c.JupyterHub.ssl_key</span></code> and <code class="docutils literal notranslate"><span class="pre">c.JupyterHub.ssl_cert</span></code>
(setting them to <code class="docutils literal notranslate"><span class="pre">None</span></code> does not have the same effect, and is an error).</p>
</section>
</section>
<section id="proxy-authentication-token">
<span id="authentication-token"></span><h2>Proxy authentication token<a class="headerlink" href="#proxy-authentication-token" title="Permalink to this heading">#</a></h2>
<p>The Hub authenticates its requests to the Proxy using a secret token that
the Hub and Proxy agree upon. Note that this applies to the default
<code class="docutils literal notranslate"><span class="pre">ConfigurableHTTPProxy</span></code> implementation. Not all proxy implementations
use an auth token.</p>
<p>The value of this token should be a random string (for example, generated by
<code class="docutils literal notranslate"><span class="pre">openssl</span> <span class="pre">rand</span> <span class="pre">-hex</span> <span class="pre">32</span></code>). You can store it in the configuration file or an
environment variable</p>
<section id="generating-and-storing-token-in-the-configuration-file">
<h3>Generating and storing token in the configuration file<a class="headerlink" href="#generating-and-storing-token-in-the-configuration-file" title="Permalink to this heading">#</a></h3>
<p>You can set the value in the configuration file, <code class="docutils literal notranslate"><span class="pre">jupyterhub_config.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">ConfigurableHTTPProxy</span><span class="o">.</span><span class="n">api_token</span> <span class="o">=</span> <span class="s1">&#39;abc123...&#39;</span> <span class="c1"># any random string</span>
</pre></div>
</div>
</section>
<section id="generating-and-storing-as-an-environment-variable">
<h3>Generating and storing as an environment variable<a class="headerlink" href="#generating-and-storing-as-an-environment-variable" title="Permalink to this heading">#</a></h3>
<p>You can pass this value of the proxy authentication token to the Hub and Proxy
using the <code class="docutils literal notranslate"><span class="pre">CONFIGPROXY_AUTH_TOKEN</span></code> environment variable:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">CONFIGPROXY_AUTH_TOKEN</span><span class="o">=</span><span class="k">$(</span>openssl rand -hex <span class="m">32</span><span class="k">)</span>
</pre></div>
</div>
<p>This environment variable needs to be visible to the Hub and Proxy.</p>
</section>
<section id="default-if-token-is-not-set">
<h3>Default if token is not set<a class="headerlink" href="#default-if-token-is-not-set" title="Permalink to this heading">#</a></h3>
<p>If you don’t set the Proxy authentication token, the Hub will generate a random
key itself, which means that any time you restart the Hub you <strong>must also
restart the Proxy</strong>. If the proxy is a subprocess of the Hub, this should happen
automatically (this is the default configuration).</p>
</section>
</section>
<section id="cookie-secret">
<span id="id1"></span><h2>Cookie secret<a class="headerlink" href="#cookie-secret" title="Permalink to this heading">#</a></h2>
<p>The cookie secret is an encryption key, used to encrypt the browser cookies
which are used for authentication. Three common methods are described for
generating and configuring the cookie secret.</p>
<section id="generating-and-storing-as-a-cookie-secret-file">
<h3>Generating and storing as a cookie secret file<a class="headerlink" href="#generating-and-storing-as-a-cookie-secret-file" title="Permalink to this heading">#</a></h3>
<p>The cookie secret should be 32 random bytes, encoded as hex, and is typically
stored in a <code class="docutils literal notranslate"><span class="pre">jupyterhub_cookie_secret</span></code> file. An example command to generate the
<code class="docutils literal notranslate"><span class="pre">jupyterhub_cookie_secret</span></code> file is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>openssl rand -hex <span class="m">32</span> &gt; /srv/jupyterhub/jupyterhub_cookie_secret
</pre></div>
</div>
<p>In most deployments of JupyterHub, you should point this to a secure location on
the file system, such as <code class="docutils literal notranslate"><span class="pre">/srv/jupyterhub/jupyterhub_cookie_secret</span></code>.</p>
<p>The location of the <code class="docutils literal notranslate"><span class="pre">jupyterhub_cookie_secret</span></code> file can be specified in the
<code class="docutils literal notranslate"><span class="pre">jupyterhub_config.py</span></code> file as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">JupyterHub</span><span class="o">.</span><span class="n">cookie_secret_file</span> <span class="o">=</span> <span class="s1">&#39;/srv/jupyterhub/jupyterhub_cookie_secret&#39;</span>
</pre></div>
</div>
<p>If the cookie secret file doesn’t exist when the Hub starts, a new cookie
secret is generated and stored in the file. The file must not be readable by
<code class="docutils literal notranslate"><span class="pre">group</span></code> or <code class="docutils literal notranslate"><span class="pre">other</span></code> or the server won’t start. The recommended permissions
for the cookie secret file are <code class="docutils literal notranslate"><span class="pre">600</span></code> (owner-only rw).</p>
</section>
<section id="id2">
<h3>Generating and storing as an environment variable<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<p>If you would like to avoid the need for files, the value can be loaded in the
Hub process from the <code class="docutils literal notranslate"><span class="pre">JPY_COOKIE_SECRET</span></code> environment variable, which is a
hex-encoded string. You can set it this way:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">JPY_COOKIE_SECRET</span><span class="o">=</span><span class="k">$(</span>openssl rand -hex <span class="m">32</span><span class="k">)</span>
</pre></div>
</div>
<p>For security reasons, this environment variable should only be visible to the
Hub. If you set it dynamically as above, all users will be logged out each time
the Hub starts.</p>
</section>
<section id="generating-and-storing-as-a-binary-string">
<h3>Generating and storing as a binary string<a class="headerlink" href="#generating-and-storing-as-a-binary-string" title="Permalink to this heading">#</a></h3>
<p>You can also set the cookie secret in the configuration file
itself, <code class="docutils literal notranslate"><span class="pre">jupyterhub_config.py</span></code>, as a binary string:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">JupyterHub</span><span class="o">.</span><span class="n">cookie_secret</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s1">&#39;64 CHAR HEX STRING&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="cookies-used-by-jupyterhub-authentication">
<span id="cookies"></span><h2>Cookies used by JupyterHub authentication<a class="headerlink" href="#cookies-used-by-jupyterhub-authentication" title="Permalink to this heading">#</a></h2>
<p>The following cookies are used by the Hub for handling user authentication.</p>
<p>This section was created based on this <a class="reference external" href="https://discourse.jupyter.org/t/how-to-force-re-login-for-users/1998/6">post</a> from Discourse.</p>
<section id="jupyterhub-hub-login">
<h3>jupyterhub-hub-login<a class="headerlink" href="#jupyterhub-hub-login" title="Permalink to this heading">#</a></h3>
<p>This is the login token used when visiting Hub-served pages that are
protected by authentication such as the main home, the spawn form, etc.
If this cookie is set, then the user is logged in.</p>
<p>Resetting the Hub cookie secret effectively revokes this cookie.</p>
<p>This cookie is restricted to the path <code class="docutils literal notranslate"><span class="pre">/hub/</span></code>.</p>
</section>
<section id="jupyterhub-user-username">
<h3>jupyterhub-user-&lt;username&gt;<a class="headerlink" href="#jupyterhub-user-username" title="Permalink to this heading">#</a></h3>
<p>This is the cookie used for authenticating with a single-user server.
It is set by the single-user server after OAuth with the Hub.</p>
<p>Effectively the same as <code class="docutils literal notranslate"><span class="pre">jupyterhub-hub-login</span></code>, but for the
single-user server instead of the Hub. It contains an OAuth access token,
which is checked with the Hub to authenticate the browser.</p>
<p>Each OAuth access token is associated with a session id (see <code class="docutils literal notranslate"><span class="pre">jupyterhub-session-id</span></code> section
below).</p>
<p>To avoid hitting the Hub on every request, the authentication response
is cached. And to avoid a stale cache the cache key is comprised of both
the token and session id.</p>
<p>Resetting the Hub cookie secret effectively revokes this cookie.</p>
<p>This cookie is restricted to the path <code class="docutils literal notranslate"><span class="pre">/user/&lt;username&gt;</span></code>, so that
only the user’s server receives it.</p>
</section>
<section id="jupyterhub-session-id">
<h3>jupyterhub-session-id<a class="headerlink" href="#jupyterhub-session-id" title="Permalink to this heading">#</a></h3>
<p>This is a random string, meaningless in itself, and the only cookie
shared by the Hub and single-user servers.</p>
<p>Its sole purpose is to coordinate logout of the multiple OAuth cookies.</p>
<p>This cookie is set to <code class="docutils literal notranslate"><span class="pre">/</span></code> so all endpoints can receive it, or clear it, etc.</p>
</section>
<section id="jupyterhub-user-username-oauth-state">
<h3>jupyterhub-user-&lt;username&gt;-oauth-state<a class="headerlink" href="#jupyterhub-user-username-oauth-state" title="Permalink to this heading">#</a></h3>
<p>A short-lived cookie, used solely to store and validate OAuth state.
It is only set while OAuth between the single-user server and the Hub
is processing.</p>
<p>If you use your browser development tools, you should see this cookie
for a very brief moment before your are logged in,
with an expiration date shorter than <code class="docutils literal notranslate"><span class="pre">jupyterhub-hub-login</span></code> or
<code class="docutils literal notranslate"><span class="pre">jupyterhub-user-&lt;username&gt;</span></code>.</p>
<p>This cookie should not exist after you have successfully logged in.</p>
<p>This cookie is restricted to the path <code class="docutils literal notranslate"><span class="pre">/user/&lt;username&gt;</span></code>, so that only
the user’s server receives it.</p>
</section>
</section>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="networking-basics.html" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Networking basics</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="authenticators-users-basics.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">Authentication and User Basics</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#enabling-ssl-encryption">
   Enabling SSL encryption
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-an-ssl-certificate">
     Using an SSL certificate
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-letsencrypt">
     Using letsencrypt
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#if-ssl-termination-happens-outside-of-the-hub">
     If SSL termination happens outside of the Hub
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#proxy-authentication-token">
   Proxy authentication token
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-and-storing-token-in-the-configuration-file">
     Generating and storing token in the configuration file
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-and-storing-as-an-environment-variable">
     Generating and storing as an environment variable
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#default-if-token-is-not-set">
     Default if token is not set
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cookie-secret">
   Cookie secret
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-and-storing-as-a-cookie-secret-file">
     Generating and storing as a cookie secret file
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Generating and storing as an environment variable
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-and-storing-as-a-binary-string">
     Generating and storing as a binary string
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cookies-used-by-jupyterhub-authentication">
   Cookies used by JupyterHub authentication
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#jupyterhub-hub-login">
     jupyterhub-hub-login
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#jupyterhub-user-username">
     jupyterhub-user-&lt;username&gt;
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#jupyterhub-session-id">
     jupyterhub-session-id
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#jupyterhub-user-username-oauth-state">
     jupyterhub-user-&lt;username&gt;-oauth-state
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  

<div class="tocsection editthispage">
    <a href="https://github.com/jupyterhub/jupyterhub/edit/main/docs/getting-started/security-basics.rst">
        <i class="fa-solid fa-pencil"></i> Edit this page
    </a>
</div>

</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="../_sources/getting-started/security-basics.rst.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>

</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1e1de1a1873e13ef5536"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2016, Project Jupyter team.<br>

</p>

  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>